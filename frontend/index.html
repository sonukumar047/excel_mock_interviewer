<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Excel Interviewer</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Chosen Palette: "Professional Ocean" - A calm and modern palette using blues, teals, and neutral grays to create a focused and professional environment. -->
    <!-- Application Structure Plan: The application is structured into three distinct stages to guide the user journey: 1) A welcoming start screen to onboard the user, 2) A dedicated interview interface with a two-column layout for the interactive Q&A, and 3) A slide-in report view for a clear, professional summary. This structure was chosen to separate the distinct user tasks (starting, interviewing, reviewing), reduce cognitive load, and provide a more polished and intuitive experience than a single, continuous chat log. -->
    <!-- Visualization & Content Choices: 
        - Interview Flow: (Goal: Interact) -> Styled chat bubbles are used for the Q&A to create a familiar, conversational feel. A typing indicator enhances this effect. (Method: Dynamic HTML/CSS).
        - Final Score: (Goal: Inform at a glance) -> A Chart.js donut chart visualizes the overall score, making it immediately impactful and easy to digest. (Library: Chart.js/Canvas).
        - Final Report: (Goal: Summarize) -> A dedicated, formatted report panel presents detailed feedback clearly. (Method: HTML/CSS with Markdown parsing via Marked.js for rich text).
        This combination provides a balanced experience of interaction and clear information delivery. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body { font-family: 'Inter', sans-serif; }
        .scrollbar-hide::-webkit-scrollbar { display: none; }
        .scrollbar-hide { -ms-overflow-style: none; scrollbar-width: none; }
        .report-panel { transition: transform 0.5s ease-in-out; }
        .report-panel.hidden { transform: translateX(100%); }
        .report-panel.visible { transform: translateX(0); }
        .fade-in { animation: fadeIn 0.5s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        .typing-indicator span {
            height: 8px;
            width: 8px;
            float: left;
            margin: 0 1px;
            background-color: #9E9E9E;
            display: block;
            border-radius: 50%;
            opacity: 0.4;
            animation: 1s blink infinite;
        }
        .typing-indicator span:nth-child(2) { animation-delay: .2s; }
        .typing-indicator span:nth-child(3) { animation-delay: .4s; }
        @keyframes blink {
            50% { opacity: 1; }
        }
    </style>
</head>
<body class="bg-slate-100 text-slate-800 flex items-center justify-center min-h-screen">

    <div id="app-container" class="w-full max-w-4xl h-[90vh] max-h-[800px] bg-white rounded-2xl shadow-2xl flex flex-col overflow-hidden">

        <!-- Welcome Screen -->
        <div id="welcome-screen" class="flex flex-col items-center justify-center h-full text-center p-8 fade-in">
            <div class="bg-sky-100 text-sky-600 rounded-full w-20 h-20 flex items-center justify-center mb-6">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10" viewBox="0 0 20 20" fill="currentColor">
                    <path fill-rule="evenodd" d="M6 2a2 2 0 00-2 2v12a2 2 0 002 2h8a2 2 0 002-2V4a2 2 0 00-2-2H6zm1 2a1 1 0 000 2h6a1 1 0 100-2H7zM7 8a1 1 0 011-1h4a1 1 0 110 2H8a1 1 0 01-1-1zm-1 4a1 1 0 100 2h6a1 1 0 100-2H6z" clip-rule="evenodd" />
                </svg>
            </div>
            <h1 class="text-3xl font-bold text-slate-900 mb-2">AI Excel Interviewer</h1>
            <p class="text-slate-600 mb-8 max-w-md">Welcome! This is an AI-powered mock interview to help you prepare for technical assessments in Microsoft Excel. Good luck!</p>
            <button id="start-btn" class="bg-sky-500 hover:bg-sky-600 text-white font-bold py-3 px-8 rounded-lg shadow-md transition-transform transform hover:scale-105">
                Start Interview
            </button>
        </div>

        <!-- Interview Screen -->
        <div id="interview-screen" class="hidden h-full flex flex-col">
            <header class="bg-slate-50 border-b border-slate-200 p-4 flex items-center justify-between flex-shrink-0">
                <h1 class="text-xl font-bold text-slate-900">Excel Mock Interview</h1>
                <div id="progress-indicator" class="text-sm font-medium text-slate-500 bg-slate-200 rounded-full px-3 py-1">Question 1 of 3</div>
            </header>

            <main class="flex-grow overflow-y-auto p-6 scrollbar-hide" id="chat-container">
                <!-- Chat messages will be appended here -->
            </main>

            <footer class="bg-slate-50 border-t border-slate-200 p-4 flex-shrink-0">
                <form id="chat-form" class="flex items-center space-x-4">
                    <input type="text" id="user-input" placeholder="Type your answer here..." autocomplete="off" class="w-full p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-sky-500 focus:border-sky-500 transition duration-200" disabled>
                    <button type="submit" id="send-btn" class="bg-sky-500 hover:bg-sky-600 text-white font-bold p-3 rounded-lg disabled:bg-slate-300 disabled:cursor-not-allowed transition-colors duration-200" disabled>
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                        </svg>
                    </button>
                </form>
            </footer>
        </div>

        <!-- Report Panel -->
        <div id="report-panel" class="report-panel hidden absolute top-0 right-0 w-full h-full bg-white z-10 flex flex-col">
             <header class="bg-slate-800 text-white p-4 flex items-center justify-between flex-shrink-0">
                <h2 class="text-xl font-bold">Final Performance Report</h2>
                <button id="restart-btn" class="bg-sky-500 hover:bg-sky-600 text-white font-bold py-2 px-4 rounded-lg transition-colors">
                    New Interview
                </button>
            </header>
            <div class="flex-grow p-8 overflow-y-auto">
                <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                    <div class="md:col-span-1 flex flex-col items-center justify-center bg-slate-50 p-6 rounded-lg">
                        <h3 class="text-lg font-semibold text-slate-700 mb-4">Overall Score</h3>
                        <div class="chart-container relative w-full max-w-[200px] h-auto aspect-square">
                            <canvas id="score-chart"></canvas>
                        </div>
                    </div>
                    <div id="report-content" class="md:col-span-2 space-y-4 prose max-w-none">
                        <!-- Report markdown will be rendered here -->
                    </div>
                </div>
            </div>
        </div>
    </div>

<script>
    const MOCK_DATA = {
        questions: [
            {
                id: "q1",
                text: "Imagine you have a sales dataset with columns: 'Date', 'Product', 'Region', and 'Sales Amount'. What is the single Excel function you would use to calculate the total sales for 'Product B' in the 'North' region?",
            },
            {
                id: "q2",
                text: "You have a list of employee birthdays in column A and you want to highlight all employees with a birthday in the current month. How would you do this using conditional formatting?",
            },
            {
                id: "q3",
                text: "The VLOOKUP function is a classic, but it has limitations. What are some of the key disadvantages of VLOOKUP, and what is a more modern, flexible alternative you could use?",
            }
        ],
        finalReport: {
            score: 85,
            content: `
### Strengths:
* Strong understanding of core Excel functions like \`SUMIF\`/\`SUMIFS\`.
* Good grasp of conditional formatting principles.

### Areas for Improvement:
* Need to be more specific with formula syntax and arguments.
* Consider alternative solutions beyond the most common ones.

### Next Steps:
* Practice with more complex nested functions and array formulas.
* Explore the \`XLOOKUP\` function and its capabilities in modern Excel.
            `
        }
    };

    const welcomeScreen = document.getElementById('welcome-screen');
    const interviewScreen = document.getElementById('interview-screen');
    const reportPanel = document.getElementById('report-panel');
    
    const startBtn = document.getElementById('start-btn');
    const chatForm = document.getElementById('chat-form');
    const userInput = document.getElementById('user-input');
    const sendBtn = document.getElementById('send-btn');
    const chatContainer = document.getElementById('chat-container');
    const progressIndicator = document.getElementById('progress-indicator');
    const restartBtn = document.getElementById('restart-btn');
    const reportContent = document.getElementById('report-content');
    const scoreChartCanvas = document.getElementById('score-chart');
    
    let scoreChart = null;
    let currentQuestionIndex = 0;
    
    function init() {
        startBtn.addEventListener('click', startInterview);
        chatForm.addEventListener('submit', handleUserAnswer);
        restartBtn.addEventListener('click', resetApp);
    }

    function startInterview() {
        welcomeScreen.classList.add('hidden');
        interviewScreen.classList.remove('hidden');
        interviewScreen.classList.add('fade-in');
        
        addAIMessage("Hello, I am the AI Excel Interviewer. I will be conducting your technical assessment today. We will go through a series of questions. Your answers will be evaluated on correctness and efficiency. Let's begin.", 500);
        
        setTimeout(askNextQuestion, 1500);
    }

    function askNextQuestion() {
        if (currentQuestionIndex < MOCK_DATA.questions.length) {
            const question = MOCK_DATA.questions[currentQuestionIndex];
            addAIMessage(question.text);
            updateProgress();
            enableInput();
        } else {
            endInterview();
        }
    }

    function handleUserAnswer(e) {
        e.preventDefault();
        const answer = userInput.value.trim();
        if (answer === '') return;

        addUserMessage(answer);
        disableInput();
        userInput.value = '';
        currentQuestionIndex++;
        
        addTypingIndicator();
        setTimeout(() => {
            removeTypingIndicator();
            askNextQuestion();
        }, 2000);
    }

    function endInterview() {
        addAIMessage("Thank you for completing the mock interview! Your final report is being generated...", 500);
        setTimeout(showReport, 2500);
    }

    function showReport() {
        reportContent.innerHTML = marked.parse(MOCK_DATA.finalReport.content);
        renderScoreChart(MOCK_DATA.finalReport.score);
        reportPanel.classList.remove('hidden');
        reportPanel.classList.add('visible');
    }
    
    function resetApp() {
        reportPanel.classList.remove('visible');
        reportPanel.classList.add('hidden');
        
        setTimeout(() => {
            chatContainer.innerHTML = '';
            currentQuestionIndex = 0;
            if (scoreChart) {
                scoreChart.destroy();
                scoreChart = null;
            }
            interviewScreen.classList.add('hidden');
            welcomeScreen.classList.remove('hidden');
            welcomeScreen.classList.add('fade-in');
        }, 500);
    }

    function addAIMessage(text, delay = 0) {
        setTimeout(() => {
            const messageElement = document.createElement('div');
            messageElement.className = 'flex justify-start mb-4 fade-in';
            messageElement.innerHTML = `
                <div class="bg-slate-200 text-slate-800 rounded-lg p-3 max-w-lg">
                    <p>${text}</p>
                </div>
            `;
            chatContainer.appendChild(messageElement);
            chatContainer.scrollTop = chatContainer.scrollHeight;
        }, delay);
    }

    function addUserMessage(text) {
        const messageElement = document.createElement('div');
        messageElement.className = 'flex justify-end mb-4 fade-in';
        messageElement.innerHTML = `
            <div class="bg-sky-500 text-white rounded-lg p-3 max-w-lg">
                <p>${text}</p>
            </div>
        `;
        chatContainer.appendChild(messageElement);
        chatContainer.scrollTop = chatContainer.scrollHeight;
    }

    function addTypingIndicator() {
        const indicatorElement = document.createElement('div');
        indicatorElement.id = 'typing-indicator';
        indicatorElement.className = 'flex justify-start mb-4 fade-in';
        indicatorElement.innerHTML = `
            <div class="bg-slate-200 rounded-lg p-3">
                <div class="typing-indicator">
                    <span></span><span></span><span></span>
                </div>
            </div>
        `;
        chatContainer.appendChild(indicatorElement);
        chatContainer.scrollTop = chatContainer.scrollHeight;
    }

    function removeTypingIndicator() {
        const indicator = document.getElementById('typing-indicator');
        if (indicator) {
            indicator.remove();
        }
    }

    function enableInput() {
        userInput.disabled = false;
        sendBtn.disabled = false;
        userInput.focus();
    }

    function disableInput() {
        userInput.disabled = true;
        sendBtn.disabled = true;
    }

    function updateProgress() {
        const totalQuestions = MOCK_DATA.questions.length;
        progressIndicator.textContent = `Question ${currentQuestionIndex + 1} of ${totalQuestions}`;
    }

    function renderScoreChart(score) {
        if (scoreChart) {
            scoreChart.destroy();
        }
        const ctx = scoreChartCanvas.getContext('2d');
        scoreChart = new Chart(ctx, {
            type: 'doughnut',
            data: {
                datasets: [{
                    data: [score, 100 - score],
                    backgroundColor: ['#0ea5e9', '#e2e8f0'],
                    borderColor: ['#ffffff', '#ffffff'],
                    borderWidth: 4,
                    borderRadius: 8,
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                cutout: '75%',
                plugins: {
                    legend: { display: false },
                    tooltip: { enabled: false }
                }
            },
            plugins: [{
                id: 'centerText',
                afterDraw: function(chart) {
                    let width = chart.width,
                        height = chart.height,
                        ctx = chart.ctx;
                    ctx.restore();
                    let fontSize = (height / 114).toFixed(2);
                    ctx.font = `bold ${fontSize}em sans-serif`;
                    ctx.textBaseline = "middle";
                    let text = `${score}%`,
                        textX = Math.round((width - ctx.measureText(text).width) / 2),
                        textY = height / 2;
                    ctx.fillStyle = '#0f172a';
                    ctx.fillText(text, textX, textY);
                    ctx.save();
                }
            }]
        });
    }

    document.addEventListener('DOMContentLoaded', init);
</script>

</body>
</html>
